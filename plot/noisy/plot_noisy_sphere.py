import matplotlib.pyplot as plt
import numpy as np
from plot.get_ave_std import get_ave_std


if __name__ == '__main__':
    ZOOpt_data = np.loadtxt('ZOOpt_exp/log/sphere_noisy_ave_std.txt')
    ave_zoopt = ZOOpt_data[0]
    std_zoopt = ZOOpt_data[1]
    CMAES_data = np.loadtxt('CMAES_exp/log/sphere_noisy_ave_std.txt')
    ave_CMAES = CMAES_data[0][25000:]
    std_CMAES = CMAES_data[1][25000:]
    print(ave_CMAES.shape)
    print(std_CMAES.shape)
    # [ave_zoopt, std_zoopt] = np.loadtxt('ZOOpt_exp/log/sphere_noisy_ave_std.txt', 10)
    ave_zoopt = ave_zoopt[25000:]
    std_zoopt = std_zoopt[25000:]
    evals=[25000, 50000, 75000, 100000, 125000, 150000, 175000, 200000]
    #ZOOpt
    a1=[2.6647921151131562, 1.9322846854562681, 1.4877054408121257, 1.2713220829583673, 1.1570947653424699, 1.0919525689517584, 1.0208155279557765, 0.94517000277692342]
    a1_std=[0.24175673863410135, 0.26339279049118919, 0.16174108057469144, 0.16424865840567851, 0.16988178400323217, 0.1638966665950628, 0.11226791567017542, 0.073449170838964115]
    sp1=[7.2674790613563847, 5.7358455171753464, 5.1862564153263966, 4.6127554155635355, 4.8564599636957242, 4.2531084289498668, 4.5057913416472166, 4.2033900250401404]
    sp1_std=[1.0614396040974421, 0.67074280829929189, 0.35622090620670355, 0.50358914089338647, 0.45309735624610781, 0.40521043512290311, 0.50099855459335385, 0.60069201571633268]
    g1=[0.48054321781474546, 0.47445738085440714, 0.50638346817184887, 0.47237480300761331, 0.4390366769210175, 0.42305628469256706, 0.4290085123863886, 0.44895631167966926]
    g1_std=[0.027610217050674589, 0.04331471884237726, 0.059679390495440278, 0.03862321709773936, 0.056432345513565373, 0.054732382690462648, 0.047629309358199055, 0.047500331394320902]
    r1=[17.781707840360831, 11.893205869083067, 9.1538251221285467, 8.6620260780135485, 8.2545679475045972, 7.2582349122338883, 7.7639187292321594, 7.0492628923671532]
    r1_std=[1.4849821437740114, 1.3934672227816993, 1.3336006360274979, 0.79909367198284242, 1.2686647102002291, 0.93964167377890084, 0.5979964827443357, 0.87556593264563276]
    sc1=[450.11006235685056, 134.49102955677736, 68.030030649879336, 39.759095016013454, 26.377271563040267, 19.004156007603161, 15.469767651493749, 11.643502586331305]
    sc1_std=[61.83701555420496, 14.337263092574366, 8.2114244550098743, 7.5121146813364659, 2.9625647196186229, 2.4495829461475025, 1.79008635027195, 2.2815115280273353]

    #CMA-ES
    a2=[0.45857406406962975, 0.45719217271540169, 0.44134917187585654, 0.47245684751165806, 0.48339520978397665, 0.4812713533939828, 0.47665834111554195, 0.48044787214553286]
    a2_std=[0.033674880825507049, 0.031120033937827578, 0.046589963956210456, 0.05605350180016868, 0.037318204932977939, 0.075853224498446142, 0.085246395119601651, 0.0608304273993188]
    sp2=[3.085244664153084, 2.8177341462727394, 2.7238617711012774, 2.804267217875958, 2.9139014913631529, 2.8989684474368298, 2.8324688535180997, 2.9820906270665426]
    sp2_std=[0.51728574369349212, 0.35911105276866578, 0.33659218048098677, 0.5111938383588519, 0.51404550860442744, 0.27659084349905055, 0.45535968712677688, 0.44204771177962793]
    g2=[3.8006849083930292, 3.9719871852402426, 3.7182413111988004, 3.9857092402323873, 3.7924524052164967, 3.7275291913008375, 4.0435393948668281, 3.8027481285608369]
    g2_std=[0.40366791354998149, 0.5556783637869015, 0.32668445194088752, 0.22814077551728826, 0.34643468527187593, 0.307720339082873, 0.23643330006585184, 0.46753326843449339]
    r2=[72.493139613971408, 74.982048625883664, 73.262346669408359, 75.22482158069343, 70.379005575909886, 81.025934305053596, 74.441024311359541, 73.135088701715603]
    r2_std=[21.006326419921216, 18.19793431381931, 13.11125950822399, 12.723736878996696, 13.366743795082678, 11.617225938742481, 8.8941196278554226, 12.309637057538575]
    sc2=[18264.650272757106, 20571.501866846364, 19458.013468267691, 17878.753386651439, 17681.399906476821, 19880.713738862971, 20954.446265880804, 17041.851037781893]
    sc2_std=[5176.2395544973324, 4391.345840915702, 5279.3729128281484, 4942.2144158322517, 4578.2535847162417, 4765.1714410166323, 3834.5668106572657, 3941.956374269691]

    #DEAP_exp
    a3=[3.8354091665851584, 3.7987863383780942, 3.835364434553898, 3.8085840614702584, 3.7934337545196435, 3.8046394361073097, 3.8093375661681939, 3.8172909679942046]
    a3_std=[0.056265023422061432, 0.0039993690135548769, 0.053717408400044353, 0.031773139453443476, 0.035456972897945339, 0.024397692731226554, 0.03077574678876837, 0.033517110516304682]
    sp3=[26.6838,23.07176,22.44436,22.59525,22.84757,23.031289,23.1353169,23.0763471]
    sp3_std=[1.58183708643319214, 1.98183708643319214, 1.28183708643319214, 1.18183708643319214,1.38183708643319214,1.08183708643319214,1.18183708643319214,1.28183708643319214]
    g3=[0.707,0.6912,0.4983901,0.4983901,0.4983901,0.4983901,0.4983901,0.4983901]
    g3_std=[0.0911222618388245303, 0.11222618388245303, 0.011222618388245303, 0.141222618388245303,0.0511222618388245303,0.0711222618388245303,0.11222618388245303,0.141222618388245303]
    r3=[350.51515,143.78,138.78,115.2833,143.7859,140.504,127.0846,125.2718]
    r3_std=[21.586903612550145, 24.586903612550145, 22.586903612550145, 18.586903612550145,21.586903612550145,16.586903612550145,21.586903612550145,24.586903612550145]
    sc3=[43420.0298,41079.0396,39077.77557,38558.7778,39118.6378,39710.931,40496.15298,39689.213]
    sc3_std=[1154.6151839876256, 1154.6151839876256, 1154.6151839876256, 1154.6151839876256,1154.6151839876256,1154.6151839876256,1154.6151839876256,1154.6151839876256]
    sp1=np.array(sp1)
    sp1_std=np.array(sp1_std)
    sp2=np.array(sp2)
    sp2_std=np.array(sp2_std)
    sp3=np.array(sp3)
    sp3_std=np.array(sp3_std)
    a1=np.array(a1)
    a1_std=np.array(a1_std)
    a2=np.array(a2)
    a2_std=np.array(a2_std)
    a3=np.array(a3)
    a3_std=np.array(a3_std)
    #plot
    x = np.arange(25000, 200000, 1)
    print(len(x))
    print(len(ave_zoopt))
    plt.fill_between(x, ave_zoopt - std_zoopt, ave_zoopt + std_zoopt, facecolor='red', alpha=0.5)
    plt.plot(x, ave_zoopt, 'r-', label='ZOOpt')
    plt.fill_between(x, ave_CMAES - std_CMAES, ave_CMAES + std_CMAES, facecolor='green', alpha=0.5)
    plt.plot(x, ave_CMAES, 'g-', label='CMAES')
    # plt.fill_between(evals, sp2 - sp2_std, sp2 + sp2_std, facecolor='green', alpha=0.5)
    # plt.plot(evals, sp2, 'g-', label='CMA-ES')
    plt.fill_between(evals, sp3 - sp3_std, sp3 + sp3_std, facecolor='blue', alpha=0.5)
    plt.plot(evals, sp3, 'b-', label='DEAP_exp')
    # plt.errorbar(evals,sp2,yerr=sp2_std,label='CMA-ES',color='blue',fmt='-')
    # plt.errorbar(evals,sp3,yerr=sp3_std,label='DEAP_exp',color='black',fmt='-')
    #plt.fill_between(evals,a1-a1_std,a1+a1_std,facecolor='red',alpha=0.3)
    #plt.plot(evals,a1,'r-',label='ZOOpt')
    #plt.fill_between(evals,a2-a2_std,a2+a2_std,facecolor='green',alpha=0.3)
    #plt.plot(evals,a2,'g-',label='CMA-ES')
    #plt.fill_between(evals,a3-a3_std,a3+a3_std,facecolor='blue',alpha=0.3)
    #plt.plot(evals,a3,'b-',label='DEAP_exp')
    plt.xlabel('budget')
    plt.ylabel('error')
    plt.title('Sphere,dim=100,sigma=1.0')
    plt.legend()
    plt.savefig('plot/img/sphere_noisy.pdf', dpi=400)
